import _ from"./commentComponent.d9fda011.js";import{u,a as r}from"./authorStore.17402b56.js";import{_ as k,s as C,c,a as o,t as d,y as f,x as p,n as g,v as I,d as S,q as P,o as a,p as w,e as y}from"./entry.448beef3.js";const b={components:{commentComponent:_},props:{postContent:{type:String,default:""},profilePicture:{type:String,default:""},userId:String,postID:String,postContent:String},data(){return{liked:!1,showCommentBox:!1,showEditPost:!1,postMainContent:this.postContent,editedPostContent:"",postImage:null,isPublic:!1}},async created(){const e=u();try{const t=await r.get(e.BASE_URL+"/authors/"+e.getAuthorId+"/posts/");console.log(t),this.postMainContent=t.data.results.content;const n=await r.get(e.BASE_URL+"/authors/"+e.getAuthorId+"/posts/"+this.postID);t.status===200?(this.post=t.data,this.getLikes()):console.error("Error fetching post:",t)}catch(t){console.error("Error while fetching post:",t)}},methods:{async getLikes(){const e=u();try{console.log("likessssss");const t=await r.get(e.BASE_URL+"/authors/"+e.getAuthorId+"/posts/"+this.postID+"/likes/");t.status===200&&(console.log("109",t.data),this.likeCount=t.data.count,this.liked=t.data.userLiked),console.log(t.data)}catch(t){console.error("Error while fetching likes:",t)}},async toggleLike(){const e=u();try{r.defaults.headers.common.Authorization=`Bearer ${e.getAuthToken}`,this.liked?(await r.post(e.BASE_URL+"/authors/"+e.getAuthorId+"/posts/"+this.postID+"/likes/",{published:new Date().toISOString()}),this.likeCount-=1):(await r.post(e.BASE_URL+"/authors/"+e.getAuthorId+"/posts/"+this.postID+"/likes/",{published:new Date().toISOString()}),this.likeCount+=1),this.liked=!this.liked}catch(t){console.error("Error while toggling like:",t)}},toggleCommentBox(){this.showCommentBox=!this.showCommentBox},onImageSelected(e){const t=e.target.files[0];if(t){const n=new FileReader;n.readAsDataURL(t),n.onload=h=>{this.postImage=h.target.result}}},async updatePost(){const e=u();this.showEditPost=!1,this.postMainContent=this.editedPostContent;const t={visibility:this.isPublic?"PUBLIC":"FRIENDS",unlisted:!1,title:"string",source:"string",origin:"string",description:"string",contentType:"string",content:this.editedPostContent,published:new Date().toISOString(),categories:"string"};r.defaults.headers.common.Authorization=`Bearer ${e.getAuthToken}`;const n=await r.post(e.BASE_URL+"/authors/"+e.getAuthorId+"/posts/"+this.postID,t);console.log(n)}}},v=e=>(w("data-v-c2ada399"),e=e(),y(),e),B={class:"post"},x={class:"post-status-icon"},E={key:0,class:"bi bi-globe"},A={key:1,class:"bi bi-lock-fill"},L={class:"user-info"},D=["src"],U={class:"user-id"},R={style:{"margin-top":"25px"}},M={class:"post-actions"},T={class:"like-count"},V={key:0},N={key:0,class:"edit-post"},O={class:"post-actions"},z={class:"upload-image"},F={class:"toggle-container"},q={class:"switch"},j=v(()=>o("span",{class:"slider"},null,-1)),G={style:{color:"white"}};function H(e,t,n,h,s,l){const m=C("comment-component");return a(),c("div",null,[o("div",B,[o("div",x,[s.isPublic?(a(),c("i",E)):(a(),c("i",A))]),o("div",L,[o("img",{src:n.profilePicture,alt:"User Profile Picture",class:"profile-pic"},null,8,D),o("span",U,d(n.userId),1)]),o("p",R,d(n.postContent),1),o("div",M,[o("button",{onClick:t[0]||(t[0]=(...i)=>l.toggleLike&&l.toggleLike(...i))},d(s.liked?"Unlike":"Like"),1),o("span",T,d(e.likeCount)+" like(s)",1),o("button",{onClick:t[1]||(t[1]=(...i)=>l.toggleCommentBox&&l.toggleCommentBox(...i))},"Comment"),o("button",{class:"edit",onClick:t[2]||(t[2]=i=>s.showEditPost=!s.showEditPost)},"Edit")]),s.showCommentBox?(a(),c("div",V,[s.showCommentBox?(a(),f(m,{key:0,postId:n.postID},null,8,["postId"])):p("",!0)])):p("",!0)]),s.showEditPost?(a(),c("div",N,[g(o("textarea",{"onUpdate:modelValue":t[3]||(t[3]=i=>s.editedPostContent=i),placeholder:"Edit your post"},null,512),[[I,s.editedPostContent]]),o("div",O,[o("label",z,[S(" Change Image "),o("input",{type:"file",onChange:t[4]||(t[4]=(...i)=>l.onImageSelected&&l.onImageSelected(...i))},null,32)]),o("div",F,[o("label",q,[g(o("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=i=>s.isPublic=i)},null,512),[[P,s.isPublic]]),j]),o("span",G,d(s.isPublic?"Public":"Private"),1)])]),o("button",{onClick:t[6]||(t[6]=(...i)=>l.updatePost&&l.updatePost(...i))},"Update Post")])):p("",!0)])}const W=k(b,[["render",H],["__scopeId","data-v-c2ada399"]]);export{W as default};
